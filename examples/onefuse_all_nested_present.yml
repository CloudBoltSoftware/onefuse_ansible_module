# OneFuse Module Provision

#Generate name (OneFuse)
- name: OneFuse Naming
  import_playbook: onefuse_naming_prov.yml
  vars:
     policy_name: '{{ naming_policy_name }}'
     tracking_id: '{{ onefuse_tracking_id }}'
  when: naming_policy_name is defined

# Get IP Address (OneFuse)
- name: OneFuse IPAM
  import_playbook: onefuse_ipam_prov.yml
  vars:
     policy_name: '{{ ipam_policy_name }}'
     tracking_id: '{{ onefuse_tracking_id }}'
  when: ipam_policy_name is defined

# Create DNS Records (OneFuse)
- name: OneFuse DNS
  import_playbook: onefuse_dns_prov.yml
  vars:
     policy_name: '{{ dns_policy_name }}'
     tracking_id: '{{ onefuse_tracking_id }}'
  when: dns_policy_name is defined

# Create Computer Object in Active Directory (OneFuse)
- name: OneFuse AD
  import_playbook: onefuse_ad_prov.yml
  vars:
     policy_name: '{{ ad_policy_name }}'
     tracking_id: '{{ onefuse_tracking_id }}'
  when: ad_policy_name is defined

# Deploy vSphere VM (vSphere)
- name: vSphere VM
  import_playbook: deploy_vsphere_vm.yml

# Create ServiceNow CMDB CI Record (OneFuse)
- name: OneFuse ServiceNow CMDB CI Record
  import_playbook: onefuse_cmdb_prov.yml
  vars:
     policy_name: '{{ cmdb_policy_name }}'
     tracking_id: '{{ onefuse_tracking_id }}'
  when: cmdb_policy_name is defined

# Run Ansible Tower Job Template (OneFuse)
- name: OneFuse run Ansible Tower Job Template
  import_playbook: onefuse_ansible_prov.yml
  vars:
     policy_name: '{{ ansible_policy_name }}'
     tracking_id: '{{ onefuse_tracking_id }}'
  when: ansible_policy_name is defined

# Run OneFuse Script (OneFuse)
- name: OneFuse run script provisioning
  import_playbook: onefuse_script_prov.yml
  vars:
     policy_name: '{{ ansible_script_name }}'
     tracking_id: '{{ onefuse_tracking_id }}'
  when: ansible_script_name is defined

# Run OneFuse vRA (OneFuse)
- name: OneFuse run vRA provisioning
  import_playbook: onefuse_vra_prov.yml
  vars:
     policy_name: '{{ ansible_vra_name }}'
     tracking_id: '{{ onefuse_tracking_id }}'
  when: ansible_vra_name is defined

# Create host in Ansible Inventory (Ansible)
- name: Create Ansible Host
  import_playbook: ansible_add_to_inventory.yml
  when: create_inventory is defined